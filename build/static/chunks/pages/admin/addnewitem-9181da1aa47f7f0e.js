(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{43136:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return W}});var t=r(16835),i=r(59874),o=r(73327),a=r(48633),c=r(50029),s=r(87794),u=r.n(s),l=r(66242),d=r(44267),f=r(36822),m=r(53457),p=r(61903),h=r(18972),x=r(86886),j=r(83321),g=r(9669),v=r.n(g),Z=r(82175),O=r(67294),b=r(72132),y=(r(64213),r(74231)),w=r(46228),P=r(27812),N=r(59499),_=r(55162),k=r(81458),G=r(40238),S=r(85893);function D(e){var n=e.file,r=e.onDelete;return(0,S.jsxs)(x.ZP,{container:!0,justifyContent:"space-between",alignItems:"center",children:[(0,S.jsx)(x.ZP,{item:!0,children:n.name}),(0,S.jsx)(x.ZP,{item:!0,children:(0,S.jsx)(j.Z,{size:"small",onClick:function(){return r(n)},children:"Delete"})})]})}function C(e){var n=e.file,r=e.onDelete,t=e.onUpload,i=(0,O.useState)(0),o=i[0],a=i[1];return(0,O.useEffect)((function(){function e(){return(e=(0,c.Z)(u().mark((function e(){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E(n,a);case 2:r=e.sent,t(n,r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),(0,S.jsxs)(x.ZP,{item:!0,children:[(0,S.jsx)(D,{file:n,onDelete:r}),(0,S.jsx)(k.Z,{variant:"determinate",value:o})]})}function E(e,n){return B.apply(this,arguments)}function B(){return(B=(0,c.Z)(u().mark((function e(n,r){var t,i,o,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="https://api.cloudinary.com/v1_1/".concat(G.tl.CLOUDINARY.NAME,"/image/upload"),e.next=3,T();case 3:return i=e.sent,o=i.signature,a=i.timestamp,e.abrupt("return",new Promise((function(e,i){var c=new XMLHttpRequest;c.open("POST",t),c.onload=function(){var n=JSON.parse(c.responseText);e(n.secure_url)},c.onerror=function(e){return i(e)},c.upload.onprogress=function(e){if(e.lengthComputable){var n=e.loaded/e.total*100;r(Math.round(n))}};var s=new FormData;s.append("file",n),s.append("signature",o),s.append("timestamp",a),s.append("api_key",G.tl.CLOUDINARY.API_KEY),c.send(s)})));case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(){return A.apply(this,arguments)}function A(){return(A=(0,c.Z)(u().mark((function e(){var n,r,t,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/api/cloudinary");case 2:return n=e.sent,e.next=5,n.json();case 5:return r=e.sent,t=r.signature,i=r.timestamp,e.abrupt("return",{signature:t,timestamp:i});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I=r(15861),R=(0,r(58377).Z)((function(e){return(0,o.Z)({bar:{backgroundColor:e.palette.error.main}})}))(k.Z);function F(e){var n=e.file,r=e.onDelete,t=e.errors;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(D,{file:n,onDelete:r}),(0,S.jsx)(R,{variant:"determinate",value:100}),t.map((function(e,n){return(0,S.jsx)("div",{children:(0,S.jsx)(I.Z,{color:"error",children:e.message})},n)}))]})}function q(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function L(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?q(Object(r),!0).forEach((function(n){(0,N.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var U=0;function z(){return++U}var X=(0,i.Z)((function(e){return{dropzone:{border:"2px dashed ".concat(e.palette.primary.main),borderRadius:e.shape.borderRadius,display:"flex",alignItems:"center",justifyContent:"center",background:e.palette.background.default,height:e.spacing(10),outline:"none"}}}));function M(e){var n=e.name,r=e.clearState,i=e.setClearState,o=X(),a=(0,Z.U$)(n),c=(0,t.Z)(a,3),s=(c[0],c[1],c[2]),u=(0,O.useState)([]),l=u[0],d=u[1],f=(0,O.useCallback)((function(e,n){var r=e.map((function(e){return{file:e,errors:[],id:z()}})),t=n.map((function(e){return L(L({},e),{},{id:z()})}));d((function(e){return[].concat((0,P.Z)(e),(0,P.Z)(r),(0,P.Z)(t))}))}),[]);function m(e,n){d((function(r){return r.map((function(r){return r.file===e?L(L({},r),{},{url:n}):r}))})),i(!1)}function p(e){d((function(n){return n.filter((function(n){return n.file!==e}))}))}(0,O.useEffect)((function(){s.setValue(l),s.setTouched(!0)}),[l]),(0,O.useEffect)((function(){r&&d([])}),[r]);var h=(0,_.u)({onDrop:f,accept:["image/*","/video/*",".pdf"],maxSize:3072e3}),j=h.getRootProps,g=h.getInputProps;return(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(x.ZP,{item:!0,children:[(0,S.jsxs)("div",L(L({},j({className:o.dropzone})),{},{children:[(0,S.jsx)("input",L({},g())),(0,S.jsx)("p",{children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u044b\u0435 \u0444\u0430\u0439\u043b\u044b"})]})),(0,S.jsx)("div",{children:l.map((function(e,n){return(0,S.jsx)(x.ZP,{item:!0,children:e.errors.length?(0,S.jsx)(F,{file:e.file,errors:e.errors,onDelete:p},n):(0,S.jsx)(C,{file:e.file,onDelete:p,onUpload:m},n)},n)}))})]})})}var Y={nameOfGoods:"",amountOfGoods:"",priceOfGoods:"",catalogNumber:"",country:"",category:"",files:[]};function J(){var e=(0,O.useState)(!1),n=e[0],r=e[1],t=Object.entries(w.od).sort((function(e,n){return e[1]<n[1]?-1:e[1]>n[1]?1:0}));return(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(l.Z,{children:(0,S.jsx)(d.Z,{children:(0,S.jsx)(Z.J9,{initialValues:Y,validationSchema:(0,y.Ry)({files:(0,y.IX)((0,y.Ry)({url:(0,y.Z_)().required()})),nameOfGoods:(0,y.Z_)().required("\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435").min(5,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u0431\u043e\u043b\u0435\u0435 5 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432").max(100,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043d\u0435 \u0431\u043e\u043b\u0435\u0435 100 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 "),amountOfGoods:(0,y.Rx)().required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435").min(0,"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u043c"),priceOfGoods:(0,y.Rx)().required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435").min(0,"\u0426\u0435\u043d\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u0435\u0435 0"),catalogNumber:(0,y.Z_)().min(2).max(6),country:(0,y.Z_)().required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435").min(2,"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u0440\u0430\u0432\u043d\u043e 2").max(100,"\u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 100 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"),category:(0,y.Z_)().required("\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435").min(2,"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432 \u0440\u0430\u0432\u043d\u043e 2").max(100,"\u041c\u0430\u043a\u0441\u0438\u043c\u0443\u043c 100 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")}),onSubmit:function(){var e=(0,c.Z)(u().mark((function e(n,t){var i,o,a;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=t.setStatus,o=t.resetForm,a=function(){var e=(0,c.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t={nameOfGoods:n.nameOfGoods,amountOfGoods:Number(n.amountOfGoods),priceOfGoods:Number(n.priceOfGoods),catalogNumber:n.catalogNumber,imageUrl:n.files.map((function(e){return e.url})),country:n.country,category:n.category},e.next=4,v().post("".concat("https://klishevich.ru","/api/addnewitem"),t);case 4:e.sent,b.Am.success("\u0422\u043e\u0432\u0430\u0440 ".concat(t.nameOfGoods," \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d"),{position:b.Am.POSITION.TOP_LEFT,autoClose:5e3}),o({}),i({success:!0}),r(!0),e.next=16;break;case 11:e.prev=11,e.t0=e.catch(0),b.Am.error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.t0.response.data.message),{position:b.Am.POSITION.TOP_LEFT,autoClose:5e3}),console.log(e.t0),i({success:!1});case 16:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),a();case 3:case"end":return e.stop()}}),e)})));return function(n,r){return e.apply(this,arguments)}}(),children:function(e,i,o){return(0,S.jsxs)(Z.l0,{children:[(0,S.jsx)(f.Z,{marginBottom:2,children:(0,S.jsxs)(m.Z,{children:[(0,S.jsx)(Z.gN,{name:"nameOfGoods",as:p.Z,label:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u043e\u0432\u0430\u0440\u0430"}),(0,S.jsx)(Z.Bc,{name:"nameOfGoods",children:function(e){return(0,S.jsx)("div",{style:{color:"red"},children:e})}})]})}),(0,S.jsx)(f.Z,{marginBottom:2,children:(0,S.jsxs)(m.Z,{children:[(0,S.jsx)(Z.gN,{name:"catalogNumber",as:p.Z,label:"\u041d\u043e\u043c\u0435\u0440 \u0442\u043e\u0432\u0430\u0440\u0430 \u0432 \u043a\u0430\u0442\u0430\u043b\u043e\u0433\u0435"}),(0,S.jsx)(Z.Bc,{name:"catalogNumber",children:function(e){return(0,S.jsx)("div",{style:{color:"red"},children:e})}})]})}),(0,S.jsx)(f.Z,{marginBottom:2,children:(0,S.jsxs)(m.Z,{children:[(0,S.jsx)(Z.gN,{name:"amountOfGoods",as:p.Z,label:"\u041a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u0430"}),(0,S.jsx)(Z.Bc,{name:"amountOfGoods",children:function(e){return(0,S.jsx)("div",{style:{color:"red"},children:e})}})]})}),(0,S.jsx)(f.Z,{marginBottom:2,children:(0,S.jsxs)(m.Z,{children:[(0,S.jsx)(Z.gN,{name:"priceOfGoods",as:p.Z,label:"\u0426\u0435\u043d\u0430 \u0442\u043e\u0432\u0430\u0440\u0430"}),(0,S.jsx)(Z.Bc,{name:"priceOfGoods",children:function(e){return(0,S.jsx)("div",{style:{color:"red"},children:e})}})]})}),(0,S.jsx)(f.Z,{marginBottom:2,children:(0,S.jsxs)(m.Z,{children:[(0,S.jsxs)(Z.gN,{name:"country",as:p.Z,select:!0,label:"\u0421\u0442\u0440\u0430\u043d\u0430",children:[(0,S.jsx)(h.Z,{value:"",children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435..."}),Object.entries(t).map((function(e,n){return(0,S.jsx)(h.Z,{value:e[1][0],children:e[1][1]},n)}))]}),(0,S.jsx)(Z.Bc,{name:"country",children:function(e){return(0,S.jsx)("div",{style:{color:"red"},children:e})}})]})}),(0,S.jsx)(f.Z,{marginBottom:2,children:(0,S.jsxs)(m.Z,{children:[(0,S.jsxs)(Z.gN,{name:"category",as:p.Z,select:!0,label:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f",children:[(0,S.jsx)(h.Z,{value:"",children:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435..."}),Object.entries(w.aA).map((function(e,n){return(0,S.jsx)(h.Z,{value:e[0],children:e[1]},n)}))]}),(0,S.jsx)(Z.Bc,{name:"category",children:function(e){return(0,S.jsx)("div",{style:{color:"red"},children:e})}})]})}),(0,S.jsxs)(x.ZP,{container:!0,spacing:2,direction:"column",children:[(0,S.jsx)(M,{name:"files",clearState:n,setClearState:r}),(0,S.jsx)(x.ZP,{item:!0,children:(0,S.jsx)(j.Z,{variant:"contained",color:"primary",type:"submit",disabled:i||o,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"})})]})]})}})})})})}var V=r(31612),H=r(65472),K=(0,i.Z)((function(){return(0,o.Z)({root:{marginTop:"50px",maxWidth:"600px",marginLeft:"auto",marginRight:"auto",textAlign:"center"}})}));function W(){var e=K(),n=(0,a.kP)(),r=(0,t.Z)(n,2),i=r[0];return r[1]?null:i?i.role!==H.S.Admin?(0,S.jsx)(V.Z,{title:"\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",children:(0,S.jsx)("h1",{children:"\u0412\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0438\u043c\u0435\u0442\u044c \u043f\u0440\u0430\u0432\u0430 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430."})}):(0,S.jsx)(V.Z,{title:"\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 | \u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u044b\u0439 \u0442\u043e\u0432\u0430\u0440",children:(0,S.jsx)("div",{className:e.root,children:(0,S.jsx)(J,{})})}):(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(V.Z,{title:"\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",children:(0,S.jsx)("h1",{children:"\u0412\u044b \u0434\u043e\u043b\u0436\u043d\u044b \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u0442\u044c\u0441\u044f."})})})}},34335:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/addnewitem",function(){return r(43136)}])}},function(e){e.O(0,[504,89,138,490,986,449,612,774,888,179],(function(){return n=34335,e(e.s=n);var n}));var n=e.O();_N_E=n}]);