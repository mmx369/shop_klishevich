(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[800],{29416:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var r=n(16835),i=n(4730),a=n(59499),c=n(55113),s=n(86886),o=n(94054),l=n(47312),u=n(40138),d=n(18972),p=n(83321),h=n(59874),m=n(73327),x=n(82175),f=n(11163),j=n(67294),y=n(82515),g=n(96126),v=n(67169),Z=n(85893),P=["countries","type"];function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=(0,h.Z)((function(){return(0,m.Z)({root:{margin:"10px",marginTop:"50px"},paper:{margin:"auto",maxWidth:"500px",padding:"2rem"}})}));function _(e){var t=e.productTypesCount,n=e.countriesCount,r=e.singleColumn,i=w(),a=(0,f.useRouter)().query,h=r?12:6,m=[0,10,100,500,1e3,5e3,1e4],y=(0,j.useState)("all"),P=y[0],b=y[1],_=m;(0,j.useEffect)((function(){_=function(e){return"all"===e?m:m.filter((function(t){return t>=e}))}(P)}),[P]);var C={type:(0,g.X)(a.type)||"all",country:(0,g.X)(a.country)||"all",minPrice:(0,g.X)(a.minPrice)||"all",maxPrice:(0,g.X)(a.maxPrice)||"all"};return(0,Z.jsx)("div",{className:i.root,"data-testid":"searchForm",children:(0,Z.jsx)(x.J9,{initialValues:C,onSubmit:function(e){f.default.push({pathname:"/shop",query:O(O({},e),{},{page:1})},void 0,{shallow:!0})},children:function(e){var r=e.values;return(0,Z.jsx)(x.l0,{children:(0,Z.jsx)(c.Z,{elevation:2,className:i.paper,children:(0,Z.jsxs)(s.ZP,{container:!0,spacing:3,children:[(0,Z.jsx)(s.ZP,{item:!0,xs:12,sm:h,children:(0,Z.jsxs)(o.Z,{fullWidth:!0,variant:"standard",children:[(0,Z.jsx)(l.Z,{id:"search-type",children:"\u0422\u0438\u043f \u0442\u043e\u0432\u0430\u0440\u0430"}),(0,Z.jsxs)(x.gN,{name:"type",as:u.Z,labelId:"search-type",label:"Type","data-testid":"productFieldSelect",children:[(0,Z.jsx)(d.Z,{value:"all",children:(0,Z.jsx)("em",{children:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435"})}),t.map((function(e){return(0,Z.jsx)(d.Z,{value:e.type,"data-testid":"selectOptionsProductTypes",children:"".concat((0,v.Jv)(e.type)," (").concat(e.count,")")},e.type)}))]})]})}),(0,Z.jsx)(s.ZP,{item:!0,xs:12,sm:h,children:(0,Z.jsx)(S,{type:r.type,name:"country",countries:n})}),(0,Z.jsx)(s.ZP,{item:!0,xs:12,sm:h,children:(0,Z.jsxs)(o.Z,{fullWidth:!0,variant:"standard",children:[(0,Z.jsx)(l.Z,{id:"search-min-price",children:"\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0446\u0435\u043d\u0430"}),(0,Z.jsxs)(x.gN,{name:"minPrice",as:u.Z,labelId:"search-min-price",label:"Min price","data-testid":"minPriceFieldSelect",children:[(0,Z.jsx)(d.Z,{value:"all",children:(0,Z.jsx)("em",{children:"\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u043e"})}),m.map((function(e){return(0,Z.jsx)(d.Z,{value:e,"data-testid":"selectOptionsMinPrice",children:e},e)}))]})]})}),(0,Z.jsx)(s.ZP,{item:!0,xs:12,sm:h,children:(0,Z.jsxs)(o.Z,{fullWidth:!0,variant:"standard",children:[(0,Z.jsx)(l.Z,{id:"search-max-price",children:"\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0446\u0435\u043d\u0430"}),(0,Z.jsxs)(x.gN,{name:"maxPrice",as:u.Z,labelId:"search-max-price",label:"Max price","data-testid":"maxPriceFieldSelect",children:[(0,Z.jsx)(d.Z,{value:"all",children:(0,Z.jsx)("em",{children:"\u041d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u043e"})}),_.map((function(e){return(0,Z.jsx)(d.Z,{value:e,"data-testid":"selectOptionsMaxPrice",children:e},e)}))]})]})}),b(r.minPrice),(0,Z.jsx)(s.ZP,{item:!0,xs:12,children:(0,Z.jsx)(p.Z,{fullWidth:!0,type:"submit",variant:"contained",color:"primary","data-testid":"searchBtn",children:"\u0418\u0441\u043a\u0430\u0442\u044c"})})]})})})}})})}function S(e){var t=e.countries,n=e.type,a=(0,i.Z)(e,P),c=(0,x.u6)().setFieldValue,s=(0,x.U$)({name:a.name}),p=(0,r.Z)(s,1)[0],h=(0,y.ZP)("/api/getcountry?type="+n,{dedupingInterval:6e4,onSuccess:function(e){e.map((function(e){return e.country})).includes(p.value)||c("country","all")}}).data||t;return(0,Z.jsxs)(o.Z,{fullWidth:!0,variant:"standard",children:[(0,Z.jsx)(l.Z,{id:"search-country",children:"\u0421\u0442\u0440\u0430\u043d\u0430"}),(0,Z.jsxs)(u.Z,O(O(O({labelId:"search-country",label:"Country"},p),a),{},{"data-testid":"countryFieldSelect",children:[(0,Z.jsx)(d.Z,{value:"all",children:(0,Z.jsx)("em",{children:"\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u0432\u0441\u0435"})}),h.map((function(e){return(0,Z.jsx)(d.Z,{value:e.country,"data-testid":"selectOptionsCountry",children:"".concat((0,v.yy)(e.country)," (").concat(e.count,")")},e.country)}))]}))]})}},96126:function(e,t,n){"use strict";function r(e){return"undefined"===typeof e?"":Array.isArray(e)?e[0]:e}n.d(t,{X:function(){return r}})},75212:function(e,t,n){"use strict";n.r(t),n.d(t,{__N_SSP:function(){return R},default:function(){return G}});var r=n(86886),i=n(59874),a=n(73327),c=n(64063),s=n.n(c),o=n(11163),l=n(17673),u=n(67294),d=n(82515),p=n(29416),h=n(31612),m=n(66242),x=n(78445),f=n(83965),j=n(44267),y=n(15861),g=n(83321),v=n(41664),Z=n(2497),P=n(40238),b=n(67169),O=n(35801),w=n(85893),_=(0,i.Z)((function(){return(0,a.Z)({media:{backgroundSize:"contain",paddingTop:"56.25%"},btn:{marginTop:"5px"}})}));function S(e){var t=e.item,n=_(),r=(0,Z.I0)();return(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)(m.Z,{elevation:1,"data-testid":"shopCard",children:[(0,w.jsx)(v.default,{href:"/shop/goods/[type]/[country]/[id]",as:"/shop/goods/".concat(t.category,"/").concat(t.country,"/").concat(t._id),children:(0,w.jsxs)("a",{"data-testid":"productDetailLink",children:[(0,w.jsx)(x.Z,{title:"".concat((0,b.Jv)(t.category)," | ").concat((0,b.yy)(t.country)),subheader:t.nameOfGoods}),(0,w.jsx)(f.Z,{className:n.media,image:t.imageUrl[0],title:t.nameOfGoods,"data-testid":"imgProduct"})]})}),(0,w.jsx)(j.Z,{children:(0,w.jsxs)(y.Z,{variant:"body2",color:"textSecondary",component:"p",children:["\u0426\u0435\u043d\u0430:"," ",(0,w.jsxs)("strong",{children:[t.priceOfGoods," ",P.$y]}),". \u041e\u0441\u0442\u0430\u0442\u043e\u043a:"," ",t.amountOfGoods>0?t.amountOfGoods+" \u0448\u0442.":"\u0422\u043e\u0432\u0430\u0440 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442",(0,w.jsx)(g.Z,{size:"small",variant:"outlined",color:"primary","data-testid":"addToCartBtn",className:n.btn,onClick:function(){var e;e=t._id,r((0,O.v5)(e,1))},children:"\u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0443"})]})})]})})}var C=n(4730),N=n(59499),T=n(70872),E=n(58886),D=n(96126),k=["item","query"];function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){(0,N.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function F(e){var t=e.totalPages,n=(0,o.useRouter)().query;return(0,w.jsx)(T.Z,{"data-testid":"paginationMenu",page:parseInt((0,D.X)(n.page)||"1"),count:t,renderItem:function(e){return(0,w.jsx)(E.Z,q({component:X,query:n,item:e},e))}})}var X=(0,u.forwardRef)((function(e,t){var n=e.item,r=e.query,i=(0,C.Z)(e,k);return(0,w.jsx)(v.default,{href:{pathname:"/shop",query:q(q({},r),{},{page:n.page})},shallow:!0,children:(0,w.jsx)("a",q(q({},i),{},{ref:t}))})})),W=(0,i.Z)((function(){return(0,a.Z)({root:{marginTop:"50px",maxWidth:"900px",marginLeft:"auto",marginRight:"auto"}})})),R=!0;function G(e){var t=e.productTypesCount,n=e.countProductsForEveryCountry,i=e.goods,a=e.totalPages,c=(0,o.useRouter)().query,m=W(),x=(0,u.useState)(c)[0],f=(0,d.ZP)("/api/shop?"+(0,l.stringify)(c),{dedupingInterval:15e3,initialData:s()(c,x)?{goods:i,totalPages:a}:void 0}).data;return(0,w.jsx)(h.Z,{title:"\u0418\u043d\u0442\u0435\u0440\u043d\u0435\u0442-\u043c\u0430\u0433\u0430\u0437\u0438\u043d | \u0411\u043e\u043d\u0438\u0441\u0442\u0438\u043a\u0430 \u0438 \u043d\u0443\u043c\u0438\u0437\u043c\u0430\u0442\u0438\u043a\u0430",children:(0,w.jsx)("div",{className:m.root,"data-testid":"searchResultPage",children:(0,w.jsxs)(r.ZP,{container:!0,spacing:2,children:[(0,w.jsx)(r.ZP,{item:!0,xs:12,sm:4,children:(0,w.jsx)(p.Z,{singleColumn:!0,productTypesCount:t,countriesCount:n})}),(0,w.jsxs)(r.ZP,{container:!0,item:!0,xs:12,sm:8,spacing:2,children:[(0,w.jsx)(r.ZP,{item:!0,xs:12,children:(0,w.jsx)(F,{totalPages:null===f||void 0===f?void 0:f.totalPages})}),((null===f||void 0===f?void 0:f.goods)||[]).map((function(e){return(0,w.jsx)(r.ZP,{item:!0,xs:12,sm:6,children:(0,w.jsx)(S,{item:e})},e._id)})),(0,w.jsx)(r.ZP,{item:!0,xs:12,children:(0,w.jsx)(F,{totalPages:null===f||void 0===f?void 0:f.totalPages})})]})]})})})}},91083:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/shop",function(){return n(75212)}])}},function(e){e.O(0,[504,89,138,490,14,604,612,774,888,179],(function(){return t=91083,e(e.s=t);var t}));var t=e.O();_N_E=t}]);